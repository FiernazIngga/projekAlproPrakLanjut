<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pengumuman User</title>
    <!-- <link rel="stylesheet" href="dasbord.css"> -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Spicy+Rice&display=swap');

        * {
            font-family: "Poppins", sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        #dashboard {
            display: flex;
            height: 100vh;
            width: 100%;
            transition: all 0.3s ease;
        }

        .navbar {
            width: 0%;
            background-color: #d1d1e9;
            transition: ease-in-out 0.6s;
            overflow: hidden;
        }

        .navbar.open {
            width: 20%;
        }

        .hamburger {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1em;
            cursor: pointer;
        }

        .affanDasbord {
            color: #2b2c34;
            white-space: nowrap;
            padding: 1em;
            font-size: 1.2em;
            transition: all 0.5s;
        }

        .isi {
            width: 100%;
            padding-left: 20px;
            transition: all 0.3s ease;
        }

        .burgerNav {
            display: flex;
            padding: 2px;
            justify-content: center;
            align-items: center;
            border-radius: 5px;
            flex-direction: column;
            width: 35px;
            height: 35px;
            margin: 10px;
            cursor: pointer;
            overflow: hidden;
            box-sizing: border-box;
        }

        .hatas, .htengah, .hbawah {
            width: 90%;
            margin: 2.5px;
            height: 3px;
            background-color: #6246ea;
            transition: all .3s;
            transform-origin: left;
        }

        .burgerNav.active .hatas {
            transform: rotate(33deg);
            width: 100%;
        }
        .burgerNav.active .htengah {
            opacity: 0;
        }
        .burgerNav.active .hbawah {
            transform: rotate(-33deg);
            width: 100%;
        }

        .menuParkir {
            list-style: none;
            padding: 0 1em;
            display: block;
        }

        .menuParkir.show {
            display: block;
        }

        .menuParkir li {
            margin: 1em 0;
        }

        .menuParkir li:nth-child(4) a {
            text-decoration: none;
            color: #fffffe;
            font-size: 1em;
            display: block;
            white-space: nowrap;
            padding: 10px;
            background-color: #6246ea;
            border-radius: 5px;
        }

        .menuParkir li:not(:nth-child(4)) a {
            text-decoration: none;
            color: #2b2c34;
            font-size: 1em;
            display: block;
            white-space: nowrap;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .menuParkir li:not(:nth-child(4)) a:hover {
            background: #6246ea;
            color: #fffffe;
        }

        .menuPengumuman {
            display: flex;
            align-items: center;
            width: 100%;
            justify-content: center;
            margin-top: 1em;
            justify-content: center;
        }

        table {
            width: 80%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-align: center;
            border-radius: 10px;
            overflow: hidden;
        }

        thead {
            background-color: #2b2c34;
            color: white;
        }

        thead th {
            padding: 15px;
            font-size: 1.2em;
        }

        tbody td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
            text-align: center;
        }

        tbody tr:hover {
            background: rgb(223, 222, 222);
        }

        .daftarLapor {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 30px;
            margin-top: 4em;
        }
        .buttonPublish {
            background-color: crimson;
            width: 7em;
            height: 3em;
            border: 0px solid white;
            color: #f8f9fa;
            cursor: pointer;
            border-radius: 7px;
            transition: all .1s;
        }
        .buttonPublish:hover, .iniEdit:hover, .iniHapus:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .buttonPublish:active, .iniEdit:active, .iniHapus:active {
            transform: translateY(0px);
        }
        .iniEdit {
            background-color: #ffd803;
            width: 7em;
            height: 3em;
            border: 0px solid white;
            color: #272343;
            cursor: pointer;
            border-radius: 7px;
            transition: all .1s;
        }
        .iniHapus {
            background-color: #6246ea;
            width: 7em;
            height: 3em;
            border: 0px solid #fffffe;
            color: #fffffe;
            cursor: pointer;
            border-radius: 7px;
            transition: all .1s;
        }
        @media screen and (max-width: 1424px) {
            .navbar.open {
                width: 500px;
            }
        }

        @media screen and (max-width: 768px) {
            .textIsi h1 {
                font-size: 1em;
            }

            .menuParkir a {
                font-size: 0.9em;
            }

            .affanDasbord {
                font-size: 1em;
            }

            .textIsi {
                height: 10em;
            }
        }

        .menuGerbang {
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .gerbang {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 300px;
            width: 170px;
            background-color: #fffffe;
            position: relative;
            border: 1px solid #000;
            border-radius: 5px;
            cursor: pointer;
            margin: 100px;
        }

        .gerbang:nth-child(1):hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        }
        .gerbang:nth-child(2):hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        }
        .gerbang:nth-child(3):hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        }

        .anekdot {
            height: 3em;
            width: 100%;
            display: flex;
            align-items: center;
        }

        .anekdot div {
            height: 15px;
            width: 15px;
            border-radius: 100%;
            margin: 5px;
        }

        .anekdot div:nth-child(1) {
            background-color: red;
        }
        .anekdot div:nth-child(2) {
            background-color: rgb(236, 236, 1);
        }
        .anekdot div:nth-child(3) {
            background-color: rgb(0, 255, 76);
        }

        .isiMenu {
            height: 100%;
            width: 100%;
            background-color: #2b2c34;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #ffffff;
        }

        .containerIsi {
            width: 90%;
            background-color: #272343;
            border-radius: 16px;
            padding: 2em;
            margin: 1.5em 0;
            height: auto;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            gap: 1.5em;
        }

        .masukinPlat {
            display: flex;
            flex-direction: column;
            gap: 1em;
            align-items: center;
            margin-top: 1em;
            width: 100%;
        }

        .masukinPlat form {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1em;
        }

        .masukinPlat label {
            color: #ffffff;
            font-size: 1.2em;
            font-weight: bold;
        }

        .masukinPlat input {
            width: 100%;
            max-width: 300px;
            height: 3em;
            text-align: center;
            border-radius: 6px;
            border: 2px solid transparent;
            outline: none;
            padding: 0 1em;
            font-size: 1em;
            transition: border 0.3s;
        }

        .masukinPlat input:focus {
            border: 2px solid #ffd803;
            background-color: #fefefe;
        }

        .masukinPlat button {
            height: 2.8em;
            width: 8em;
            cursor: pointer;
            background-color: #ffd803;
            border-radius: 6px;
            border: none;
            font-weight: bold;
            color: #272343;
            transition: all 0.3s ease-in-out;
        }

        .masukinPlat button:hover {
            border: 2px solid #ffd803;
            background-color: transparent;
            color: #ffd803;
        }

        .container2 {
            border: 1px dashed #fff;
            padding: 1em;
            border-radius: 10px;
            min-height: 6em;
            display: none;
            flex-direction: column;
            gap: 1em;
            color: #fff;
        }

        .isiPlatKeluar {
            display: flex;
            flex-direction: column;
            gap: 0.8em;
            font-size: 1.1em;
            padding: 1em;
            border-radius: 10px;
        }

        .inputBayar {
            display: flex;
            flex-direction: column;
            gap: 0.8em;
            font-size: 1.1em;
            padding: 1em;
            border-radius: 10px;
        }

        .data-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5em 1em;
            border-bottom: 1px dashed #888;
        }

        .label {
            color: #ffd803;
            font-weight: 600;
        }

        .value {
            color: #ffffff;
            font-weight: 500;
        }
        .menuPembayaran {
            margin-top: -1em;
        }
        .inputBayar.invalid {
            border-color: red;
            border: 2px solid red;
            background-color: #ffe6e6;
        }

        .bayarKendaraan:disabled {
            background-color: gray;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <section id="dashboard">
        <div class="navbar">
            <h1 class="affanDasbord">Affan Jaya's Mall</h1>
            <div class="isianDabsord">
                <ul class="menuParkir">
                    <li><a href="/">Home</a></li>
                    <li><a href="/kendaraanMasuk">Kendaraan Masuk</a></li>
                    <li><a href="/cekKendaraan">Cek Kendaraan</a></li>
                    <li><a href="/kendaraanKeluar">Kendaraan Keluar</a></li>
                    <li><a href="/riwayatKendaraanKeluar">Riwayat Kendaraan</a></li>
                    <li><a href="/pengumuman">Menu Pengumuman</a></li>
                    <li><a href="/pengumumanLaporPengguna">Pengumuman User</a></li>
                </ul>
            </div>
        </div>
            <div class="isi">
                <div class="burgerNav" id="hamburgerMenu">
                    <div class="hatas"></div>
                    <div class="htengah"></div>
                    <div class="hbawah"></div>
                </div>
                <div class="menuGerbang">
                    <div class="containerIsi">
                        <div class="masukinPlat">
                            <form>
                                <label for="platKeluar">Plat Kendaraan Keluar : </label>
                                <input id="platKeluar" type="text" placeholder="Masukin Plat Pengguna">
                                <button class="cariPlatYangKeluar">Cari Plat</button>
                            </form>
                        </div>
                        <div class="container2">
                            <div class="isiPlatKeluar">
                                <div class="data-item">
                                    <span class="label">ID Kendaraan:</span>
                                    <span class="value id">Memuat....</span>
                                </div>
                                <div class="data-item">
                                    <span class="label">Tipe Kendaraan:</span>
                                    <span class="value tipe">Memuat....</span>
                                </div>
                                <div class="data-item">
                                    <span class="label">Plat Kendaraan:</span>
                                    <span class="value plat">Memuat....</span>
                                </div>
                                <div class="data-item">
                                    <span class="label">Biaya Kendaraan:</span>
                                    <span class="value biaya">Memuat....</span>
                                </div>
                                <div class="data-item">
                                    <span class="label">Waktu Masuk:</span>
                                    <span class="value waktuMasuk">Memuat....</span>
                                </div>                  
                                <div class="data-item">
                                    <span class="label">Waktu Keluar:</span>
                                    <span class="value waktuKeluar">Memuat....</span>
                                </div>                  
                            </div>
                            <div class="menuPembayaran">
                                <div class="masukinPlat">
                                    <form>
                                        <label for="inputBayar">Masukkan Nominal Uang : </label>
                                        <input id="inputBayar" type="text" placeholder="Cth: 6000 / 3000">
                                        <button class="bayarKendaraan" disabled>Bayar</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </section>


<script>
    const navbar = document.querySelector('.navbar');
    const hamburger = document.querySelector('#hamburgerMenu');
    const burgerNav = document.querySelector('.burgerNav');
    const buttonPub = document.querySelector('#publis');
    const isiKeluar = document.getElementById('isiKeluar');
    let tutupIsi = 1;

    hamburger.addEventListener('click', () => {
        navbar.classList.toggle('open');
        burgerNav.classList.toggle('active');
    });

    async function bayarKendaraanKeluar(idPlat, uangBayar, hargaParkir) {
        const response = await fetch(`/hapusKendaraanKeluar/${idPlat}`);
        const respon = await response.json();
        if (respon.cekBol) {
            alert(`${respon.message}`);
            let uangYangDibayar = parseInt(uangBayar);
            let uangSistem = parseInt(hargaParkir);
            if (uangYangDibayar > uangSistem) {
                const kembalian = uangBayar - hargaParkir;
                alert('Uang kembalian : Rp. ' + (kembalian));
            } else {
                alert('Uang pembayaran passs');
            }
            location.reload();
        } else {
            alert(`${respon.message}`);
        }
    }

    async function kirimDataKenKeluar(plat) {
        try {
            console.log(plat)
            const response = await fetch(`/kendaraanAkanKeluar`, {
                method: 'POST',
                headers: {'Content-Type' : 'application/json'},
                body: JSON.stringify({'PlatCari' : plat})
            });
            console.log(`/kendaraanAkanKeluar/${plat}`)
            const respon = await response.json();
            document.querySelector('.container2').style.display = "flex";
            console.log(respon)
            if (respon.cekBol) {
                document.querySelector('.id').textContent = `${respon.id}`;
                document.querySelector('.tipe').textContent = `${respon.tipe}`;
                document.querySelector('.plat').textContent = `${respon.plat}`;
                document.querySelector('.biaya').textContent = `${respon.biaya}`;
                document.querySelector('.waktuMasuk').textContent = `${respon.waktuMsk}`;
                document.querySelector('.waktuKeluar').textContent = `${respon.waktuKlr}`;

                const inputBayar = document.querySelector('#inputBayar');
                const tombolBayar = document.querySelector('.bayarKendaraan');
                inputBayar.dataset.biaya = respon.biaya; 
                inputBayar.value = '';
                inputBayar.classList.add('invalid');
                tombolBayar.disabled = true;
                if (tombolBayar.disabled) {
                    console.log(respon.id, "Ini adalah id kendaraan dimana kendaraan akan keluar")
                    tombolBayar.addEventListener('click', () => {
                        bayarKendaraanKeluar(respon.id, inputBayar.value, respon.biaya);
                    });
                }
            } else {
                document.querySelector('.isiPlatKeluar').innerHTML = `${respon.message}`;
                document.querySelector('.isiPlatKeluar').style.color = "red";
            }
        } catch (error) {
            if (error) {
                alert(error)
            }
        }
    }
        
        document.querySelector('.cariPlatYangKeluar').addEventListener('click', (event) => {
        event.preventDefault();
        if (!confirm("Apakah plat sudah benar?")) {
            return;
        }
        kirimDataKenKeluar(document.querySelector('#platKeluar').value.trim())
        const inputBayar = document.querySelector('#inputBayar');
        const tombolBayar = document.querySelector('.bayarKendaraan');

        inputBayar.addEventListener('input', () => {
            const nilai = parseInt(inputBayar.value);
            const biaya = parseInt(inputBayar.dataset.biaya || 0);

            if (!isNaN(nilai) && nilai >= biaya) {
                tombolBayar.disabled = false;
            } else {
                tombolBayar.disabled = true;
            }
        });
    });
</script>
</body>
</html>


